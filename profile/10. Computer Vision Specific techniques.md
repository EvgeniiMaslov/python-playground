



[**Computer Vision**](#computer vision)

* [Histogram of Oriented Gradients](#Histogram of Oriented Gradients)







## Computer Vision



### Histogram of Oriented Gradients

The Histogram of Gradients is a straightforward feature extraction procedure that was developed in the context of identifying pedestrians within images. HOG involves the following steps: 

1. Optionally prenormalize images. This leads to features that resist dependence on variations in illumination.
2. Convolve the image with two filters that are sensitive to horizontal and vertical brightness gradients. These capture edge, contour, and texture information. 
3. Subdivide the image into cells of a predetermined size, and compute a histogram of the gradient orientations within each cell.
4. Normalize the histograms in each cell by comparing to the block of neighboring cells. This further suppresses the effect of illumination across the image. 
5. Construct a one-dimensional feature vector from the information in each cell.

```python
from skimage import data, color, feature
import skimage.data
 
image = color.rgb2gray(data.chelsea())
hog_vec, hog_vis = feature.hog(image, visualise=True)

fig, ax = plt.subplots(1, 2, figsize=(12, 6),
                       subplot_kw=dict(xticks=[], yticks=[]))

ax[0].imshow(image, cmap='gray')
ax[0].set_title('input image')

ax[1].imshow(hog_vis)
ax[1].set_title('visualization of HOG features');

```

**HOG in Action: A Simple Face Detector** 

Using these HOG features, we can build up a simple facial detection algorithm with any Scikit-Learn estimator; here we will use a linear support vector machine. 

The steps are as follows: 

1. Obtain a set of image thumbnails of faces to constitute “positive” training samples. 
2. Obtain a set of image thumbnails of nonfaces to constitute “negative” training samples. 
3. Extract HOG features from these training samples.
4. Train a linear SVM classifier on these samples.
5. For an “unknown” image, pass a sliding window across the image, using the model to evaluate whether that window contains a face or not. 
6. If detections overlap, combine them into a single window.